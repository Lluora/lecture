```
해당 답안을 보고 내가 이해한 바로 적은 것이라 정확하지 않을 수 있다.
주석에 내가 이해한 부분을 적었고 따로 느낀 부분들을 적었다.
```

<br>

### db 저장  
<br>

***idx*** - 번호(데이터의 유니크한 번호)      
***title*** - 타이틀(제목)        
***content*** - 내용(간단한 내용)       
***reg_date*** - 저장 데이트 타임         

<br>

#### javascript
```javascript
        function postArticle() {
            let url = $("#post-url").val(); //제목
            let comment = $("#post-comment").val(); //간단한 내용 

            // 2. memo에 POST 방식으로 메모 생성 요청하기
            $.ajax({
                type: "POST",
                url: "/post",
                data: {title: url, content: comment},
                success: function (response) { // 성공하면
                    if (response["result"] == "success") {
                        alert("포스팅 성공!");
                        // 3. 성공 시 페이지 새로고침하기
                        window.location.reload();
                    } else {
                        alert("서버 오류!");
                    }
                }
            })
        }
```

<br>

#### python
```python
@app.route('/post', methods=['POST'])
def save_post():
    title = request.form.get('title')
    content = request.form.get('content')
    post_count = db.post.count()
    if post_count == 0: # 저장된 DB가 없으면
        max_value = 1  # INDEX 1
    else:
        max_value = db.post.find_one(sort=[("idx", -1)])['idx'] + 1
        # 최근 날짜 순으로 정렬하고 가장 마지막 INDEX 번호에서 +1로 저장하기

    post = {
        'idx': max_value,
        'title': title,
        'content': content,
        'reg_date': datetime.now()
    }
    db.post.insert_one(post)
    return {"result": "success"}
```


<br>

DB에는 저장을 저장한 순서대로 idx를 저장한다. 

3개 데이터 저장 | 4개 데이터 저장 | 
|---|:---:|
<img src = https://user-images.githubusercontent.com/74857364/135761554-fdbf856d-0852-49e9-b710-d364622be3b7.png width="80%"> | <img src = https://user-images.githubusercontent.com/74857364/135761560-c7889c5c-f917-49c2-9014-3c1cd3a1261d.png width="70%"> |

<br>

---

### reg_date 컬럼을 사용하여 최근에 작성한 글이 상위에 위치하도록 최신순으로 정렬

<br>

#### python
```python
@app.route('/post', methods=['GET'])
def get_post():
    posts = list(db.post.find({}, {'_id': False}).sort([("reg_date", -1)])) # 정렬
    for a in posts:
        a['reg_date'] = a['reg_date'].strftime('%Y.%m.%d %H:%M:%S') #2021.10.03 23:00:00 형식으로 출력

    return jsonify({"posts": posts})
```

#### javascript
```javascript
        function showArticles() {
            $.ajax({
                type: "GET",
                url: "/post",
                data: {},
                success: function (response) {
                    let posts = response["posts"];
                    for (let i = 0; i < posts.length; i++) {
                        makeListPost(posts[i], i);
                    }
                }
            })
        }


        function makeListPost(post, index) { // 화면 띄우기
            let tempHtml = ` <tr>
                      <th scope="row">${index + 1}</th>
                      <td>${post['title']}</td>
                      <td>${post['reg_date']}</button></td>
                      <td><button type="button" class="btn btn-danger" onclick="deleteArticle(${post['idx']})">삭제</button></td>
                      </tr>
                    `;
            $("#list-post").append(tempHtml);
        }
```

<br>

db에는 ***idx***를 1씩 증가하면서 넣고 표에는 ***index***를 새로 생성해서 브라우저에 띄우고 삭제를 할 때는 ***idx***를 이용해서 삭제를 했다.

나는 db에 **idx**를 저장해서 **idx**만 브라우저에 최신 순으로 표에 띄우고 그 **idx**를 이용해서 삭제하는 줄로 생각해서 

어떻게 구현할지 몰랐는데 잘못생각한 것이었다.😅


---

### 데이터의 유니크한 번호인 idx 컬럼을 사용하여 삭제

<br>

#### python
```python
@app.route('/post', methods=['DELETE'])
def delete_post():
    idx = request.args.get('idx')
    db.post.delete_one({'idx': int(idx)})
    return {"result": "success"}
```
<br>

#### javascript
```javascript
        function deleteArticle(idx) {
            $.ajax({
                type: "DELETE",
                url: `/post?idx=${idx}`,
                success: function (response) { // 성공하면
                    if (response["result"] == "success") {
                        alert("삭제 성공!");
                        // 3. 성공 시 페이지 새로고침하기
                        window.location.reload();
                    } else {
                        alert("서버 오류!");
                    }
                }
            })
        }
```
